# 智能自动跟随书包

本项目是一个智能自动跟随书包系统，书包固定在带轮底盘上，通过 UWB 超宽带定位实现自动跟随，配合姿态检测、称重、路径示教等功能，降低学生负重。

## 功能模式

| 模式 | 名称 | 功能描述 |
|---|---|---|
| 0 | 待机模式 | 显示重量；重量 > 1kg 时蜂鸣器提示三声 |
| 1 | 背负模式 | MPU6050 检测弯腰/驼背/高低肩，异常时蜂鸣 |
| 2 | 跟随模式 | UWB 定位自动跟随；距离 <= 1m 停止 |
| 3 | 手拉模式 | 关闭自动控制，手动拉车 |
| 4 | 归位模式 | 回放已示教路线 |
| 5 | 示教模式 | 蓝牙遥控小车，记录动作与时长 |

## 按钮逻辑

- 单击：待机 → 背负 → 跟随 → 示教 → 手拉 → 待机
- 双击：进入归位模式（回放示教路线）
- 长按（≥1秒）：切换 WS2812 灯带开关

## 硬件清单（关键）

- ESP32 Dev Module
- UWB 定位模块 ×2（主机 0000，从机 0001/0002）
- MPU6050
- HX711 + 称重传感器
- OLED SSD1306 0.96"
- L298N 电机驱动
- WS2812 灯带（30 颗）

## 引脚示例

| 模块 | 引脚 | 说明 |
|---|---|---|
| 按钮 | GPIO4 | 单击/双击/长按 |
| 蜂鸣器 | GPIO23 | 低电平有效 |
| UWB0 | RX16 / TX17 | 主机串口2 |
| UWB1 | RX27 / TX13 | 从机串口1 |
| MPU6050 | SDA25 / SCL26 | I2C1 |
| OLED | SDA21 / SCL22 | I2C0 |
| L298N | IN1=5 IN2=14 IN3=32 IN4=33 | IN 脚 PWM 调速 |
| WS2812 | GPIO12 | 30 颗灯珠 |

## 串口/蓝牙命令

| 命令 | 功能 |
|---|---|
| W/A/S/D/X | 前进/左转/后退/右转/停止 |
| F/B/L/R/X | 前进/后退/左转/右转/停止 |
| M | 切换模式 |
| P | 进入示教模式 |
| E | 进入归位模式 |
| T | 称重去皮 |
| C | IMU 校准 |

## 路径示教与归位

- 进入示教模式后，用蓝牙遥控小车
- 系统记录动作与时长
- 进入归位模式后，自动回放示教路线

## 测试清单

- [ ] OLED 显示正常
- [ ] 单击切换模式
- [ ] 双击进入归位
- [ ] 长按切换灯带
- [ ] 背负模式姿态提示
- [ ] 跟随模式能正常移动
- [ ] 示教/归位可用
- [ ] 蓝牙遥控可用
